<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">
  {%- include head.html -%}

  <body onload="setModifiedDate();">

    {%- include header.html -%}

    <main id="content">
    {{ content }}
    </main>

    {%- include footer.html -%}

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="{{ site.baseurl }}/assets/scripts/index.js?{{site.time | date: '%s'}}"></script>
    <script>
      $(".criteria-checkbox").change(function() {
          var arr = [];
          arr.push([ '#a11y - {{ page.url | replace: '/', '' | capitalize }} Accessibility Acceptance Criteria' ]);
          $(".criteria-checkbox:checked").each(function(){
              var $this = $(this);
              arr.push([ $this.data('success-criteria') ]);
          });
          var textarea = document.getElementById("criteria-area");
          textarea.value = arr.join("\n");
          console.log(arr);
      });
      $("#copy").click(function(){
          $("#criteria-area").select();
          document.execCommand('copy');
      });

      function setModifiedDate() {
        if (document.getElementById('last-modified')) {
          fetch("https://api.github.com/repos/tmobile/magentaA11y/commits?path={{ page.path }}")
            .then((response) => {
              return response.json();
            })
            .then((commits) => {
              var modified = commits[0]['commit']['committer']['date'].slice(0,10);
              if(modified != "{{ page.date | date: "%Y-%m-%d" }}") {
                document.getElementById('last-modified').textContent = "Last modified: " + modified;
              }
            });
          }
        }
    </script>
  </body>
</html>
